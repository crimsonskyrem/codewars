class Solution:
    def twoCitySchedCost(self, costs) -> int:
        diff = {}
        cityA = []
        cityB = []
        bias = 0
        for cost in costs:
            tmp = cost[0]-cost[1]
            if tmp not in diff:
                diff[tmp] = cost
            else:
                if tmp > 0:
                    cityA.append(cost[1])
                    bias -= 1
                else:
                    cityB.append(cost[0])
                    bias += 1

        for i in sorted(diff):
            if len(cityA) + bias < len(costs)/2:
                cityA.append(diff[i][0])
            else:
                cityB.append(diff[i][1])
        return sum(cityA) + sum(cityB)


s = Solution()
print(s.twoCitySchedCost([[10,20],[30,200],[400,50],[30,20]]) == 110)
print(s.twoCitySchedCost([[10,10],[30,30],[400,400],[30,30]]) == 470)
print(s.twoCitySchedCost([[515,563],[451,713],[537,709],[343,819],[855,779],[457,60],[650,359],[631,42]]) == 3086)
print(s.twoCitySchedCost([[259,770],[448,54],[926,667],[184,139],[840,118],[577,469]]) == 1859)
print(s.twoCitySchedCost([[945,563],[598,753],[558,341],[372,54],[39,522],[249,459],[536,264],[491,125],[367,118],[34,665],[472,410],[109,995],[147,436],[814,112],[45,545],[561,308],[491,504],[113,548],[626,104],[556,206],[538,592],[250,460],[718,134],[809,221],[893,641],[404,964],[980,751],[111,935]])==7542)
print(s.twoCitySchedCost([[955,371],[706,603],[321,738],[122,541],[555,207],[790,344],[170,424],[512,771],[833,437],[655,376],[378,459],[276,702],[943,789],[614,489],[634,494],[958,328],[333,736],[475,887],[531,240],[152,923],[958,31],[1,536],[942,275],[618,174],[880,532],[672,808],[996,903],[85,204],[927,703],[96,181],[263,823],[947,92],[146,553],[875,123]]) == 11709)
print(s.twoCitySchedCost([[481,639],[846,131],[402,724],[151,820],[942,828],[604,465],[672,226],[11,190],[42,932],[753,451],[673,92],[196,261],[990,96],[767,820],[734,539],[241,164],[43,281],[862,788],[394,6],[245,553],[779,408],[288,228],[412,17],[935,24],[894,302],[709,189],[734,602],[601,752],[774,820],[783,480],[769,284],[741,515],[898,890],[46,623],[278,248],[634,33],[437,363],[140,210],[309,901],[347,220],[503,590],[345,505],[456,303],[799,597],[961,45],[583,111],[320,572],[321,308],[805,361],[943,28],[22,31],[464,995],[779,35],[1000,345]]) == 17034)